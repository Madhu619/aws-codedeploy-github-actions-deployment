{"ast":null,"code":"import _slicedToArray from\"/Users/madhusudhana.rk/Desktop/react/divine-collections/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect}from\"react\";import{useSetState}from'react-use';import{LocalStorageValues}from\"../utils/types\";import{jsx as _jsx}from\"react/jsx-runtime\";export var initialState={isLoggedIn:false,isLoginPending:false,loginError:null,loginUser:{}};export var AuthContext=/*#__PURE__*/React.createContext(initialState);var localLogin=localStorage.getItem(LocalStorageValues.LOGIN_USER);export var ContextProvider=function ContextProvider(props){var _useSetState=useSetState(initialState),_useSetState2=_slicedToArray(_useSetState,2),state=_useSetState2[0],setState=_useSetState2[1];var setLoginPending=function setLoginPending(isLoginPending){return setState({isLoginPending:isLoginPending});};var setLoginSuccess=function setLoginSuccess(isLoggedIn){return setState({isLoggedIn:isLoggedIn});};var setLoginError=function setLoginError(loginError){return setState({loginError:loginError});};var setLoginUser=function setLoginUser(loginUser){return setState({loginUser:loginUser});};var login=function login(userName,password){setLoginPending(true);setLoginSuccess(false);setLoginError(null);setLoginUser(null);var res=fetchLogin(userName,password);res.then(function(result){if(result.error){setLoginError(result);}else{setLoginError(null);setLoginUser(result);setLoginPending(false);setLoginSuccess(true);localStorage.setItem(LocalStorageValues.LOGIN_USER,JSON.stringify(result));}}).catch(function(error){return setLoginError(error);});};var logout=function logout(){setLoginPending(false);setLoginSuccess(false);setLoginError(null);setLoginUser(null);localStorage.clear();};useEffect(function(){if(localLogin){setState({isLoginPending:false,isLoggedIn:true,loginUser:JSON.parse(localLogin)});}},[setState]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{state:state,login:login,logout:logout},children:props.children});};var fetchLogin=function fetchLogin(userName,password){return fetch(\"http://localhost:8000/login\",{method:\"POST\",headers:{'Content-Type':'application/json',\"Access-Control-Allow-Origin\":\"localhost, 0.0.0.0/0\",\"Access-Control-Allow-Methods\":\"POST, PUT, GET, OPTIONS\",\"Access-Control-Allow-Headers\":\"Origin, X-Requested-With, Content-Type, Accept, Authorization\"},body:JSON.stringify({userName:userName,password:password})}).then(function(result){return result.json();}).catch(function(error){return error;});};","map":{"version":3,"names":["React","useEffect","useSetState","LocalStorageValues","initialState","isLoggedIn","isLoginPending","loginError","loginUser","AuthContext","createContext","localLogin","localStorage","getItem","LOGIN_USER","ContextProvider","props","state","setState","setLoginPending","setLoginSuccess","setLoginError","setLoginUser","login","userName","password","res","fetchLogin","then","result","error","setItem","JSON","stringify","catch","logout","clear","parse","children","fetch","method","headers","body","json"],"sources":["/Users/madhusudhana.rk/Desktop/react/divine-collections/client/src/contexts/userContext.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport { useSetState } from 'react-use';\nimport { LocalStorageValues } from \"../utils/types\";\n\nexport interface iLoginProps {\n  isLoggedIn: boolean,\n  isLoginPending: boolean,\n  loginError: string | null,\n  loginUser: any,\n}\n\nexport interface iAuthProps {\n  state: iLoginProps,\n  login: (userName: string, password: string) => void,\n  logout: () => void,\n}\nexport const initialState: iLoginProps | any = {\n  isLoggedIn: false,\n  isLoginPending: false,\n  loginError: null,\n  loginUser: {}\n}\nexport const AuthContext = React.createContext(initialState);\nconst localLogin = localStorage.getItem(LocalStorageValues.LOGIN_USER);\n\nexport const ContextProvider = (props: any) => {\n  const [state, setState] = useSetState<any>(initialState);\n\n  const setLoginPending = (isLoginPending: boolean) => setState({isLoginPending});\n  const setLoginSuccess = (isLoggedIn: boolean) => setState({isLoggedIn});\n  const setLoginError = (loginError: string | null) => setState({loginError});\n  const setLoginUser = (loginUser: any) => setState({loginUser});\n\n  const login = (userName: string, password: string) => {\n    setLoginPending(true);\n    setLoginSuccess(false);\n    setLoginError(null);\n    setLoginUser(null);\n\n    const res = fetchLogin( userName, password )\n    res.then(result => {\n      if (result.error) {\n        setLoginError(result)\n      } else {\n        setLoginError(null)\n        setLoginUser(result);\n        setLoginPending(false);\n        setLoginSuccess(true);\n        localStorage.setItem(LocalStorageValues.LOGIN_USER, JSON.stringify(result));\n      }\n    }).catch( error =>\n      setLoginError(error)\n    )\n  }\n\n  const logout = () => {\n    setLoginPending(false);\n    setLoginSuccess(false);\n    setLoginError(null);\n    setLoginUser(null);\n    localStorage.clear();\n  }\n\n  useEffect(() => {\n    if (localLogin) {\n      setState({\n        isLoginPending: false,\n        isLoggedIn: true,\n        loginUser: JSON.parse(localLogin)\n      })\n    }\n  }, [setState])\n\n  return (\n    <AuthContext.Provider\n      value={{\n        state,\n        login,\n        logout,\n      }}\n    >\n      {props.children}\n    </AuthContext.Provider>\n  );\n};\n\nconst fetchLogin = (userName: string, password:string ) => \n  fetch(\"http://localhost:8000/login\", {\n    method: \"POST\",\n    headers: {\n      'Content-Type': 'application/json',\n      \"Access-Control-Allow-Origin\": \"localhost, 0.0.0.0/0\",\n      \"Access-Control-Allow-Methods\": \"POST, PUT, GET, OPTIONS\",\n      \"Access-Control-Allow-Headers\": \"Origin, X-Requested-With, Content-Type, Accept, Authorization\"\n    },\n    body: JSON.stringify({userName: userName, password: password}),\n  }).then((result)=> result.json())\n  .catch(error => error)"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}