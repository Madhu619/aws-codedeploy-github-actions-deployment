{"ast":null,"code":"import _regeneratorRuntime from\"/Users/madhusudhana.rk/Desktop/react/divine-collections/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/madhusudhana.rk/Desktop/react/divine-collections/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/madhusudhana.rk/Desktop/react/divine-collections/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Suspense,useContext,useEffect,useState}from'react';import{useNavigate,useParams}from'react-router-dom';import comingSoonBanner from'../utils/icons/coming-soon.jpeg';import{Container,Row,Col,Button}from'react-bootstrap';import getPrice from'../utils/priceHelper';import{AuthContext}from'../contexts/userContext';import{CartContext}from'../contexts/cartContext';import Payments from'./Payments/Payments';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Product=function Product(){var _useParams=useParams(),id=_useParams.id;var _useState=useState(comingSoonBanner),_useState2=_slicedToArray(_useState,2),productImage=_useState2[0],setProductImage=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),product=_useState4[0],setProduct=_useState4[1];var navigate=useNavigate();var loadImage=function loadImage(){if(product!==null&&product!==void 0&&product.image){import(\"../utils/images/\".concat(product===null||product===void 0?void 0:product.image,\".jpg\")).then(function(image){setProductImage(image.default);});}};var _useContext=useContext(AuthContext),_id=_useContext.state.loginUser._id;var _useContext2=useContext(CartContext),cartDetails=_useContext2.state.cartDetails,insertCartItems=_useContext2.insertCartItems,removeCartItems=_useContext2.removeCartItems;var _useState5=useState(cartDetails.items.filter(function(item){return item===id;}).length),_useState6=_slicedToArray(_useState5,2),alreadyInCart=_useState6[0],checkAlreadyInCart=_useState6[1];useEffect(function(){function getproducts(){return _getproducts.apply(this,arguments);}function _getproducts(){_getproducts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,message,products;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:8000/category/product/\".concat(id));case 2:response=_context.sent;if(response.ok){_context.next=7;break;}message=\"An error occured: \".concat(response.statusText);window.alert(message);return _context.abrupt(\"return\");case 7:_context.next=9;return response.json();case 9:products=_context.sent;setProduct(products);case 11:case\"end\":return _context.stop();}}},_callee);}));return _getproducts.apply(this,arguments);}getproducts();return;},[id]);useEffect(function(){checkAlreadyInCart(cartDetails.items.filter(function(item){return item===id;}).length);},[cartDetails,id]);var addToCart=function addToCart(){if(!_id){navigate(\"/login\");}else{insertCartItems(_id,product===null||product===void 0?void 0:product.id);}};var removeFromCart=function removeFromCart(){if(!_id){navigate(\"/login\");}else{removeCartItems(_id,product===null||product===void 0?void 0:product.id);}};if(!product){return null;}loadImage();return/*#__PURE__*/_jsx(Suspense,{fallback:\"... Loading\",children:/*#__PURE__*/_jsx(Container,{className:\"product-wrapper\",fluid:true,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{sm:4,className:\"product-image\",children:/*#__PURE__*/_jsx(\"img\",{width:\"100%\",src:productImage,alt:\"\".concat(product.name)})}),/*#__PURE__*/_jsxs(Col,{sm:4,className:\"product-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"product-name\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\" \",product.name]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-price\",children:[\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"price bold\",children:[\" \",getPrice(product.price,product.discount),\" \"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-desc\",children:[\" \",product.description,\" \"]})]}),/*#__PURE__*/_jsxs(Col,{sm:4,className:\"product-actions\",children:[!alreadyInCart?/*#__PURE__*/_jsx(Button,{className:\"btn btn-primary\",onClick:function onClick(){addToCart();},children:\" Add to Cart \"}):/*#__PURE__*/_jsx(Button,{className:\"btn btn-danger\",onClick:function onClick(){removeFromCart();},children:\" Remove from Cart \"}),/*#__PURE__*/_jsx(Payments,{product:product,userId:_id})]})]})})});};export default Product;","map":{"version":3,"names":["React","Suspense","useContext","useEffect","useState","useNavigate","useParams","comingSoonBanner","Container","Row","Col","Button","getPrice","AuthContext","CartContext","Payments","Product","id","productImage","setProductImage","product","setProduct","navigate","loadImage","image","then","default","_id","state","loginUser","cartDetails","insertCartItems","removeCartItems","items","filter","item","length","alreadyInCart","checkAlreadyInCart","getproducts","fetch","response","ok","message","statusText","window","alert","json","products","addToCart","removeFromCart","name","price","discount","description"],"sources":["/Users/madhusudhana.rk/Desktop/react/divine-collections/client/src/components/Product.tsx"],"sourcesContent":["import React, { Suspense, useContext, useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { CardsList } from '../utils/types';\nimport comingSoonBanner from '../utils/icons/coming-soon.jpeg';\nimport { Container, Row, Col, Button } from 'react-bootstrap';\nimport getPrice from '../utils/priceHelper';\nimport { AuthContext } from '../contexts/userContext';\nimport { CartContext } from '../contexts/cartContext';\nimport Payments from './Payments/Payments';\n\nconst Product : React.FC= () => {\n  const {id} = useParams<string>();\n  const [productImage, setProductImage] = useState(comingSoonBanner);\n  const [product, setProduct] = useState<CardsList>();\n  const navigate = useNavigate();\n  const loadImage = () => {\n    if ( product?.image ) {\n      import(`../utils/images/${product?.image}.jpg`).then(image => {\n        setProductImage(image.default)\n      });\n    }\n  };\n  const {state: {loginUser: {_id}}} = useContext(AuthContext);\n  const {state: {cartDetails}, insertCartItems, removeCartItems} = useContext(CartContext);\n  const [alreadyInCart, checkAlreadyInCart] = useState(cartDetails.items.filter((item: any )=> item === id).length);\n  useEffect(() => {\n    async function getproducts() {\n      const response = await fetch(`http://localhost:8000/category/product/${id}`);\n      if (!response.ok) {\n        const message = `An error occured: ${response.statusText}`;\n        window.alert(message);\n        return;\n      }\n      const products = await response.json();\n      setProduct(products);\n    }\n    getproducts();\n    return; \n  },[id])\n\n  useEffect(() => {\n    checkAlreadyInCart(cartDetails.items.filter((item: any )=> item === id).length)\n  }, [cartDetails, id])\n\n  const addToCart = () => {\n    if (!_id) {\n      navigate(\"/login\");\n    } else {\n      insertCartItems(_id, product?.id)\n    }\n  }\n\n  const removeFromCart = () => {\n    if (!_id) {\n      navigate(\"/login\");\n    } else {\n      removeCartItems(_id, product?.id)\n    }\n  }\n\nif (!product) {\n  return null\n}\n  loadImage();\n  return (\n    <Suspense fallback={\"... Loading\"} >\n      <Container className='product-wrapper' fluid>\n        <Row>\n          <Col sm={4} className='product-image'>\n            <img width='100%' src={productImage} alt={`${product.name}`}/>\n          </Col>\n          <Col sm={4} className='product-details'>\n            <div className=\"product-name\"><strong> {product.name}</strong></div>\n            <div className=\"product-price\"> <span className=\"price bold\"> {getPrice(product.price, product.discount)} </span>\n            </div>\n            <div className=\"product-desc\"> {product.description} </div>\n          </Col>\n          <Col sm={4} className='product-actions'>\n            { !alreadyInCart ?\n              <Button className='btn btn-primary' onClick={() => {\n                addToCart()\n              }} > Add to Cart </Button> :\n\n              <Button className='btn btn-danger' onClick={() => {\n                removeFromCart()\n              }} > Remove from Cart </Button>\n            }\n            <Payments product={product} userId={_id} />\n          </Col>\n        </Row>\n      </Container>\n    </Suspense>\n  )\n}\nexport default Product;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}