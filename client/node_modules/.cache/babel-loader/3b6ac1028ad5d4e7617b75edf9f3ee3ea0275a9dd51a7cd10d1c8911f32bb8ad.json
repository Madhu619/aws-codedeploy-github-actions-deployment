{"ast":null,"code":"import _slicedToArray from\"/Users/madhusudhana.rk/Desktop/react/divine-collections/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useEffect,useContext,useCallback}from\"react\";import{useSetState}from'react-use';import{AuthContext}from\"./userContext\";import{jsx as _jsx}from\"react/jsx-runtime\";export var initialState={cartDetails:{items:[]}};export var CartContext=/*#__PURE__*/createContext(initialState);export var CartContextProvider=function CartContextProvider(props){var _useSetState=useSetState(initialState),_useSetState2=_slicedToArray(_useSetState,2),state=_useSetState2[0],setState=_useSetState2[1];var _useContext=useContext(AuthContext),loginUser=_useContext.state.loginUser;var setCartItems=useCallback(function(cartDetails){return setState({cartDetails:cartDetails});},[setState]);var getCartItems=useCallback(function(id){var res=getCartDetails(id);res.then(function(result){setCartItems(result);}).catch(function(error){return console.log(error);});},[setCartItems]);var insertCartItems=function insertCartItems(id,itemId){insertIntoCart(id,itemId).then(function(result){setCartItems(result);}).catch(function(error){return console.log(error);});};var removeCartItems=function removeCartItems(id,itemId){removeFromCart(id,itemId).then(function(result){setCartItems(result);}).catch(function(error){return console.log(error);});};useEffect(function(){if(loginUser&&Object.keys(loginUser).length>0){getCartItems(loginUser._id);}},[loginUser,getCartItems]);return/*#__PURE__*/_jsx(CartContext.Provider,{value:{state:state,getCartItems:getCartItems,insertCartItems:insertCartItems,removeCartItems:removeCartItems},children:props.children});};var insertIntoCart=function insertIntoCart(id,itemId){return fetch(\"http://localhost:8000/product/addToCart\",{method:'POST',headers:{'Content-Type':'application/json',\"Access-Control-Allow-Origin\":\"localhost, 0.0.0.0/0\",\"Access-Control-Allow-Methods\":\"POST, PUT, GET, OPTIONS\",\"Access-Control-Allow-Headers\":\"Origin, X-Requested-With, Content-Type, Accept, Authorization\"},body:JSON.stringify({userId:id,itemId:itemId})}).then(function(result){return result.json();}).catch(function(error){return error;});};var getCartDetails=function getCartDetails(id){return fetch(\"http://localhost:8000/cart/\".concat(id)).then(function(response){return response.json();}).then(function(result){return result;}).catch(function(error){return error;});};var removeFromCart=function removeFromCart(id,itemId){return fetch(\"http://localhost:8000/product/removeFromCart\",{method:'POST',headers:{'Content-Type':'application/json',\"Access-Control-Allow-Methods\":\"POST, PUT, GET, OPTIONS\",\"Access-Control-Allow-Headers\":\"Origin, X-Requested-With, Content-Type, Accept, Authorization\"},body:JSON.stringify({userId:id,itemId:itemId})}).then(function(result){return result.json();}).catch(function(error){return error;});};","map":{"version":3,"names":["createContext","useEffect","useContext","useCallback","useSetState","AuthContext","initialState","cartDetails","items","CartContext","CartContextProvider","props","state","setState","loginUser","setCartItems","getCartItems","id","res","getCartDetails","then","result","catch","error","console","log","insertCartItems","itemId","insertIntoCart","removeCartItems","removeFromCart","Object","keys","length","_id","children","fetch","method","headers","body","JSON","stringify","userId","json","response"],"sources":["/Users/madhusudhana.rk/Desktop/react/divine-collections/client/src/contexts/cartContext.tsx"],"sourcesContent":["import { createContext, useEffect, useContext, useCallback } from \"react\";\nimport { useSetState } from 'react-use';\nimport { AuthContext } from \"./userContext\";\n\nexport interface iCartProps {\n  cartDetails: any,\n}\n\nexport interface iAuthProps {\n  state: iCartProps,\n  getCartItems: () => void,\n}\nexport const initialState: iCartProps | any = {\n  cartDetails: {items: []},\n}\nexport const CartContext = createContext(initialState);\n\nexport const CartContextProvider = (props: any) => {\n  const [state, setState] = useSetState<any>(initialState);\n  const {state: { loginUser }} = useContext(AuthContext);\n\n  const setCartItems = useCallback((cartDetails: any) => setState({cartDetails}),[setState]);\n\n  const getCartItems = useCallback((id: any) => {\n    const res = getCartDetails( id )\n    res.then(result => {\n      setCartItems(result);\n    }).catch( error =>\n      console.log(error)\n    )\n  },[setCartItems])\n\n  const insertCartItems = (id: string, itemId: string) => {\n    insertIntoCart( id, itemId )\n    .then(result => {\n      setCartItems(result);\n    }).catch( error =>\n      console.log(error)\n    )\n  }\n\n  const removeCartItems = (id: string, itemId: string) => {\n    removeFromCart( id, itemId )\n    .then(result => {\n      setCartItems(result);\n    }).catch( error =>\n      console.log(error)\n    )\n  }\n\n  useEffect(() => {\n    if (loginUser && Object.keys(loginUser).length > 0){\n      getCartItems(loginUser._id);\n    }\n  }, [loginUser, getCartItems])\n\n  return (\n    <CartContext.Provider\n      value={{\n        state,\n        getCartItems,\n        insertCartItems,\n        removeCartItems\n      }}\n    >\n      {props.children}\n    </CartContext.Provider>\n  );\n};\nconst insertIntoCart = (id: string, itemId: string ) => \n  fetch(`http://localhost:8000/product/addToCart`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      \"Access-Control-Allow-Origin\": \"localhost, 0.0.0.0/0\",\n      \"Access-Control-Allow-Methods\": \"POST, PUT, GET, OPTIONS\",\n      \"Access-Control-Allow-Headers\": \"Origin, X-Requested-With, Content-Type, Accept, Authorization\"\n    },\n    body: JSON.stringify({userId: id, itemId: itemId}),\n  }).then(result => result.json())\n  .catch(error => error)\n\nconst getCartDetails = (id: string ) => \nfetch(`http://localhost:8000/cart/${id}`)\n.then((response) => response.json())\n.then(result => result)\n.catch(error =>  error )\n\nconst removeFromCart = (id: string, itemId: string ) => \n  fetch(`http://localhost:8000/product/removeFromCart`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      \"Access-Control-Allow-Methods\": \"POST, PUT, GET, OPTIONS\",\n      \"Access-Control-Allow-Headers\": \"Origin, X-Requested-With, Content-Type, Accept, Authorization\"\n    },\n    body: JSON.stringify({userId: id, itemId: itemId}),\n  }).then(result => result.json())\n  .catch(error => error)\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}