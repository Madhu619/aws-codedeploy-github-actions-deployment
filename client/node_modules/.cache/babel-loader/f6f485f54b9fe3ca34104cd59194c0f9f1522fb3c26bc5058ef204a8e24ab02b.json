{"ast":null,"code":"import _regeneratorRuntime from\"/Users/madhusudhana.rk/Desktop/react/divine-madhu619/divine-collections/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/madhusudhana.rk/Desktop/react/divine-madhu619/divine-collections/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from'react';import logo from'../../utils/icons/logo.jpeg';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";var Payments=function Payments(_ref){var product=_ref.product,userId=_ref.userId;var initializeRazorpay=function initializeRazorpay(){return new Promise(function(resolve){var script=document.createElement(\"script\");script.src='https://checkout.razorpay.com/v1/checkout.js';script.onload=function(){resolve(true);};script.onerror=function(){resolve(false);};document.body.appendChild(script);});};function displayRazorpay(){return _displayRazorpay.apply(this,arguments);}function _displayRazorpay(){_displayRazorpay=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res,id,price,description,name,discount,finalAmount,result,_result$data,amount,order_id,currency,options,paymentObject;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return initializeRazorpay();case 2:res=_context2.sent;if(res){_context2.next=6;break;}alert(\"Razorpay SDK failed to load. Are you online?\");return _context2.abrupt(\"return\");case 6:id=product.id,price=product.price,description=product.description,name=product.name,discount=product.discount;finalAmount=discount?price-price/(100/discount):price;// creating a new order\n_context2.next=10;return axios.post(\"http://localhost:8000/create/orderId\",{amount:finalAmount*100,id:userId});case 10:result=_context2.sent;if(result){_context2.next=14;break;}alert(\"Server error. Are you online?\");return _context2.abrupt(\"return\");case 14:// Getting the order details back\n_result$data=result.data,amount=_result$data.amount,order_id=_result$data.id,currency=_result$data.currency;options={key:process.env.RAZORPAY_KEY_LIVE,// Enter the Key ID generated from the Dashboard\namount:amount.toString(),name:\"Divine Collections\",currency:currency,productId:id,productDescription:description,description:\"Payment for \"+name,order_id:order_id,prefill:{name:\"Divine Collections\",email:\"sales@divinecollections.in\",contact:\"9591734665\"},image:logo,notes:{address:\"Divine Collections, Corporate Office, Bengaluru\"},theme:{color:\"#3399cc\"},config:{display:{blocks:{banks:{name:'Quick and safe method',instruments:[{method:'card'},{method:'upi'}]}},sequence:['block.banks'],preferences:{show_default_blocks:true}}},handler:function(){var _handler=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(response){var data,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:data={orderCreationId:order_id,razorpayPaymentId:response.razorpay_payment_id,razorpayOrderId:response.razorpay_order_id,razorpaySignature:response.razorpay_signature};_context.next=3;return axios.post(\"http://localhost:8000/payment/success\",data);case 3:result=_context.sent;window.confirm(result.data.message);case 5:case\"end\":return _context.stop();}}},_callee);}));function handler(_x){return _handler.apply(this,arguments);}return handler;}(),modal:{ondismiss:function ondismiss(){if(window.confirm(\"Are you sure, you want to close the form?\")){console.log(\"Checkout form closed by the user\");}else{console.log(\"Complete the Payment\");}}}};paymentObject=new window.Razorpay(options);paymentObject.open();case 18:case\"end\":return _context2.stop();}}},_callee2);}));return _displayRazorpay.apply(this,arguments);}return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"main\",{className:\"font-Inter h-screen overflow-auto bg-gradient-to-tr from-[#252B30] to-[#191C22]\",children:/*#__PURE__*/_jsx(\"div\",{className:\"relative z-10 flex flex-col md:flex-row mt-10 items-center  max-w-6xl justify-evenly mx-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"md:w-1/3 mb-20 md:mb-0 mx-10\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-[#3e4044] to-[#1D2328] p-[1px] rounded-md mb-4\",children:/*#__PURE__*/_jsx(\"button\",{className:\"App-link btn btn-success\",onClick:displayRazorpay,children:\"Buy Now\"})})})})})});};export default Payments;","map":{"version":3,"names":["React","logo","axios","Payments","product","userId","initializeRazorpay","Promise","resolve","script","document","createElement","src","onload","onerror","body","appendChild","displayRazorpay","res","alert","id","price","description","name","discount","finalAmount","post","amount","result","data","order_id","currency","options","key","process","env","RAZORPAY_KEY_LIVE","toString","productId","productDescription","prefill","email","contact","image","notes","address","theme","color","config","display","blocks","banks","instruments","method","sequence","preferences","show_default_blocks","handler","response","orderCreationId","razorpayPaymentId","razorpay_payment_id","razorpayOrderId","razorpay_order_id","razorpaySignature","razorpay_signature","window","confirm","message","modal","ondismiss","console","log","paymentObject","Razorpay","open"],"sources":["/Users/madhusudhana.rk/Desktop/react/divine-madhu619/divine-collections/client/src/components/Payments/Payments.tsx"],"sourcesContent":["import React from 'react';\nimport logo from '../../utils/icons/logo.jpeg'\nimport axios from 'axios';\nimport { CardsList } from \"../../utils/types\";\n\ninterface iPayments {\n  product: CardsList,\n  userId: string\n}\n\nconst Payments: React.FC<iPayments> = ({\n  product,\n  userId\n}) =>  {\n  const initializeRazorpay = () => {\n    return new Promise((resolve) => {\n      const script = document.createElement(\"script\");\n      script.src = 'https://checkout.razorpay.com/v1/checkout.js';\n      script.onload = () => {\n        resolve(true);\n      };\n      script.onerror = () => {\n          resolve(false);\n      };\n      document.body.appendChild(script);\n    });\n  }\n  async function displayRazorpay() {\n    const res = await initializeRazorpay()\n    if (!res) {\n        alert(\"Razorpay SDK failed to load. Are you online?\");\n        return;\n    }\n    const { id, price, description, name, discount } = product;\n    const finalAmount = discount ? price - ( price / ( 100 / discount)) : price;\n    // creating a new order\n    const result = await axios.post(\"http://localhost:8000/create/orderId\", {\n      amount: finalAmount * 100,\n      id: userId\n    } );\n\n    if (!result) {\n        alert(\"Server error. Are you online?\");\n        return;\n    }\n\n    // Getting the order details back\n    const { amount, id: order_id, currency } = result.data;\n\n    const options = {\n      key: process.env.RAZORPAY_KEY_LIVE, // Enter the Key ID generated from the Dashboard\n      amount: amount.toString(),\n      name: \"Divine Collections\",\n      currency: currency,\n      productId: id,\n      productDescription: description,\n      description: \"Payment for \"+ name,\n      order_id: order_id,\n      prefill: {\n        name: \"Divine Collections\",\n        email: \"sales@divinecollections.in\",\n        contact: \"9591734665\",\n      },\n      image: logo,\n      notes: {\n          address: \"Divine Collections, Corporate Office, Bengaluru\",\n      },\n      theme: {\n        color: \"#3399cc\"\n      },\n      config: {\n        display: {\n          blocks: {\n            banks: {\n              name: 'Quick and safe method',\n              instruments: [\n                {\n                  method: 'card',\n                },\n                {\n                  method: 'upi'\n                },\n                ],\n            },\n          },\n          sequence: ['block.banks'],\n          preferences: {\n            show_default_blocks: true,\n          },\n        },\n      },\n      handler: async function (response: any) {\n          const data = {\n              orderCreationId: order_id,\n              razorpayPaymentId: response.razorpay_payment_id,\n              razorpayOrderId: response.razorpay_order_id,\n              razorpaySignature: response.razorpay_signature,\n          };\n\n          const result = await axios.post(\"http://localhost:8000/payment/success\", data);\n\n          window.confirm(result.data.message);\n      },\n      modal: {\n        ondismiss: function () {\n          if (window.confirm(\"Are you sure, you want to close the form?\")) {\n            console.log(\"Checkout form closed by the user\");\n          } else {\n            console.log(\"Complete the Payment\")\n          }\n        }\n      }\n    };\n\n    const paymentObject =  new (window as any).Razorpay(options);\n    paymentObject.open();\n  }\n  return (\n    <div>\n      <main className=\"font-Inter h-screen overflow-auto bg-gradient-to-tr from-[#252B30] to-[#191C22]\">\n      <div className=\"relative z-10 flex flex-col md:flex-row mt-10 items-center  max-w-6xl justify-evenly mx-auto\">\n        <div className=\"md:w-1/3 mb-20 md:mb-0 mx-10\">\n          <div className=\"bg-gradient-to-r from-[#3e4044] to-[#1D2328] p-[1px] rounded-md mb-4\">\n            <button className=\"App-link btn btn-success\" onClick={displayRazorpay}>\n              Buy Now\n            </button>\n          </div>\n        </div>\n      </div>\n      </main>\n    </div>\n  );\n}\n\nexport default Payments;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}